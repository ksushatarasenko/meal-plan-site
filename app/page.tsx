(полный код из canvas вставится позже)